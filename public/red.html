<html>
    <style>
        html, body{
            height: 100%;
            background: red;
        }
    </style>

    <body>
        <button id="signOut">Sign out</button>
    </body>

    <script src="/__/firebase/6.3.1/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="/__/firebase/6.3.1/firebase-auth.js"></script>
    <script src="/__/firebase/6.3.1/firebase-firestore.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <!-- Initialize Firebase -->
    <script src="/__/firebase/init.js"></script>
    <script>

        $(document).ready(function()
        {
            firebase.auth().onAuthStateChanged(user =>
            {
                var sessionTimeout = null;
                if(user)
                {
                    console.log("logged in" + firebase.auth().currentUser);

                    //Set session timeout, so the user is logged out automatically after some time
                    user.getIdTokenResult().then((idTokenResult)=>
                    {
                        const authTime = idTokenResult.claims.auth_time * 1000;
                        const sessionDuration = 1000 * 60 * 60 * 3; //1000*64 = ~1 minute expiration -> right now set for 3 hours
                        const milsUntilExpiration = sessionDuration - (Date.now() - authTime);
                        sessionTimeout = setTimeout(() => firebase.auth().signOut(), milsUntilExpiration);
                    })
                }
                else
                {
                    console.log("Logged out" + firebase.auth().currentUser);

                    sessionTimeout && clearTimeout(sessionTimeout);
                    sessionTimeout = null;

                    window.location = "index.html";
                }
            });

            //Sign user out when sign out button is clicked
            $("#signOut").click(function()
            {
                firebase.auth().signOut();
            });
        });

    </script>
</html>